<div class="bg-white relative overflow-hidden group main-card-hover">
  <div class="h-full border-2 border-gray-200 border-opacity-60 rounded-lg overflow-hidden">
    <a [routerLink]="['/details',product._id,product.slug]">
      <img
        class="lg:h-72 md:h-36 w-full object-contain object-center"
        [src]="product.imageCover"
        [alt]="product.title"
      />
    </a>

    <div class="p-6">
      <span>{{product.category.name}}</span>
      <div class="flex justify-between">
        <h2 class="title-font text-lg font-bold text-gray-900 mb-3 line-clamp-1">
          {{ product.title }}
        </h2>
        <span class="font-bold inline-flex items-center leading-none text-sm text-rating">
          {{ product.ratingsAverage }} <i class="fa-solid fa-star"></i>
        </span>
      </div>
      <p class="leading-relaxed mb-3 line-clamp-2">{{ product.description }}</p>
      <div class="flex items-center justify-between">
        <button
          [disabled]="isLoadingCart"
          (click)="addToCart(product._id)"
          class="btn-main text-center w-3/4"
        >
          @if(isLoadingCart){
            Adding... <i class="fas fa-spinner fa-spin mx-2"></i>
          }@else{
            Add to cart
          }
        </button>
        <span class="text-black font-extrabold text-lg inline-flex items-center leading-none">
          {{ product.price }} $
        </span>
      </div>
    </div>
  </div>

  <!-- Wishlist Button -->
  <button
    (click)="toggleWishlist(product._id)"
    [disabled]="isLoadingWishlist"
    class="cursor-pointer absolute top-5 end-5 duration-200 ease-in translate-x-[200%] group-hover:translate-x-0 disabled:opacity-50"
    [attr.aria-label]="isInWishlist ? 'Remove from wishlist' : 'Add to wishlist'"
  >
    <div class="inline-flex flex-col items-center cursor-pointer group/heart">
      <span class="relative w-8 h-8 inline-block">
        @if(isLoadingWishlist) {
          <i class="fas fa-spinner fa-spin text-red-700 text-4xl absolute inset-0"></i>
        } @else {
          @if(isInWishlist) {
            <!-- Filled heart when in wishlist -->
            <i class="fa-solid fa-heart text-red-700 text-4xl absolute inset-0"></i>
          } @else {
            <!-- Empty heart with hover effect -->
            <i
              class="fa-regular fa-heart text-red-700 text-4xl absolute inset-0 opacity-100 group-hover/heart:opacity-0 transition-opacity duration-300"
            ></i>
            <i
              class="fa-solid fa-heart text-red-700 text-4xl absolute inset-0 opacity-0 group-hover/heart:opacity-100 transition-opacity duration-300"
            ></i>
          }
        }
      </span>
    </div>
  </button>
</div>
